<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Concurrent::Actor::Behaviour::Buffer
  
    &mdash; Concurrent
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Concurrent/Actor/Behaviour/Buffer.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Actor.html" title="Concurrent::Actor (module)">Actor</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span></span>
     &raquo; 
    <span class="title">Buffer</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Concurrent::Actor::Behaviour::Buffer
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Abstract.html" title="Concurrent::Actor::Behaviour::Abstract (class)">Abstract</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Abstract.html" title="Concurrent::Actor::Behaviour::Abstract (class)">Abstract</a></span></li>
          
            <li class="next">Concurrent::Actor::Behaviour::Buffer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/concurrent/actor/behaviour/buffer.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Any message reaching this behaviour is buffered. Only one message is is scheduled
at any given time. Others are kept in buffer until another one can be scheduled.
This effective means that messages handled by behaviours before buffer have higher priority
and they can be processed before messages arriving into buffer. This allows to
process internal actor messages like (<code>:link</code>, <code>:supervise</code>) processed first.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#core-instance_method" title="#core (instance method)">- (Object) <strong>core</strong> </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      inherited
      from <span class='object_link'><a href="Abstract.html#core-instance_method" title="Concurrent::Actor::Behaviour::Abstract#core (method)">Abstract</a></span>
    </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute core.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#subsequent-instance_method" title="#subsequent (instance method)">- (Object) <strong>subsequent</strong> </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      inherited
      from <span class='object_link'><a href="Abstract.html#subsequent-instance_method" title="Concurrent::Actor::Behaviour::Abstract#subsequent (method)">Abstract</a></span>
    </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute subsequent.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Buffer) <strong>initialize</strong>(core, subsequent) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Buffer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_envelope-instance_method" title="#on_envelope (instance method)">- (Object) <strong>on_envelope</strong>(envelope) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_event-instance_method" title="#on_event (instance method)">- (Object) <strong>on_event</strong>(event) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_envelope-instance_method" title="#process_envelope (instance method)">- (Object) <strong>process_envelope</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process_envelopes%3F-instance_method" title="#process_envelopes? (instance method)">- (Boolean) <strong>process_envelopes?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Ensures that only one envelope processing is scheduled with #schedule_execution, this allows other scheduled blocks to be executed before next envelope processing.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Concurrent::Actor::Behaviour::Buffer (class)">Buffer</a></span></tt>) <strong>initialize</strong>(core, subsequent) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Buffer</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/actor/behaviour/buffer.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_core'>core</span><span class='comma'>,</span> <span class='id identifier rubyid_subsequent'>subsequent</span><span class='rparen'>)</span>
  <span class='kw'>super</span> <span class='id identifier rubyid_core'>core</span><span class='comma'>,</span> <span class='id identifier rubyid_subsequent'>subsequent</span>
  <span class='ivar'>@buffer</span>                     <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@receive_envelope_scheduled</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="core-instance_method">
  
    - (<tt>Object</tt>) <strong>core</strong>  <span class="extras">(readonly)</span>
  

  

  
    <span class="not_defined_here">
      Originally defined in class
        <span class='object_link'><a href="Abstract.html#core-instance_method" title="Concurrent::Actor::Behaviour::Abstract#core (method)">Abstract</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute core</p>


  </div>
</div>
<div class="tags">
  

</div>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="subsequent-instance_method">
  
    - (<tt>Object</tt>) <strong>subsequent</strong>  <span class="extras">(readonly)</span>
  

  

  
    <span class="not_defined_here">
      Originally defined in class
        <span class='object_link'><a href="Abstract.html#subsequent-instance_method" title="Concurrent::Actor::Behaviour::Abstract#subsequent (method)">Abstract</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute subsequent</p>


  </div>
</div>
<div class="tags">
  

</div>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="on_envelope-instance_method">
  
    - (<tt>Object</tt>) <strong>on_envelope</strong>(envelope) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/actor/behaviour/buffer.rb', line 17</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_envelope'>on_envelope</span><span class='lparen'>(</span><span class='id identifier rubyid_envelope'>envelope</span><span class='rparen'>)</span>
  <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='id identifier rubyid_envelope'>envelope</span>
  <span class='id identifier rubyid_process_envelopes?'>process_envelopes?</span>
  <span class='const'>MESSAGE_PROCESSED</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_event-instance_method">
  
    - (<tt>Object</tt>) <strong>on_event</strong>(event) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/actor/behaviour/buffer.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_event'>on_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_event'>event</span>
  <span class='kw'>when</span> <span class='symbol'>:terminated</span><span class='comma'>,</span> <span class='symbol'>:restarted</span>
    <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_envelope'>envelope</span><span class='op'>|</span> <span class='id identifier rubyid_reject_envelope'>reject_envelope</span> <span class='id identifier rubyid_envelope'>envelope</span> <span class='rbrace'>}</span>
    <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
  <span class='kw'>end</span>
  <span class='kw'>super</span> <span class='id identifier rubyid_event'>event</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_envelope-instance_method">
  
    - (<tt>Object</tt>) <strong>process_envelope</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/actor/behaviour/buffer.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process_envelope'>process_envelope</span>
  <span class='id identifier rubyid_envelope'>envelope</span> <span class='op'>=</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_envelope'>envelope</span>
  <span class='id identifier rubyid_pass'>pass</span> <span class='id identifier rubyid_envelope'>envelope</span>
<span class='kw'>ensure</span>
  <span class='ivar'>@receive_envelope_scheduled</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_schedule_execution'>schedule_execution</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_process_envelopes?'>process_envelopes?</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_envelopes?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>process_envelopes?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Ensures that only one envelope processing is scheduled with #schedule_execution,
this allows other scheduled blocks to be executed before next envelope processing.
Simply put this ensures that Core is still responsive to internal calls (like add_child)
even though the Actor is flooded with messages.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/actor/behaviour/buffer.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process_envelopes?'>process_envelopes?</span>
  <span class='kw'>unless</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='ivar'>@receive_envelope_scheduled</span>
    <span class='ivar'>@receive_envelope_scheduled</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_process_envelope'>process_envelope</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Aug 14 08:32:30 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.2).
</div>

<script>
//  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
//    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
//      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
//  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
//
//  ga('create', 'UA-4005004-8', 'pitr.ch');
//  ga('send', 'pageview');
</script>

  </body>
</html>