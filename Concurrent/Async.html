<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Concurrent::Async
  
    &mdash; Concurrent
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Concurrent/Async.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../root/Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span>
     &raquo; 
    <span class="title">Async</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Concurrent::Async
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/concurrent/async.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A mixin module that provides simple asynchronous behavior to any standard
class/object or object. </p>

<pre class="code cucumber"><code class="cucumber">Feature:
  As a stateful, plain old Ruby class/object
  I want safe, asynchronous behavior
  So my long-running methods don&#39;t block the main thread
</code></pre>

<p>Stateful, mutable objects must be managed carefully when used asynchronously.
But Ruby is an object-oriented language so designing with objects and classes
plays to Ruby&#39;s strengths and is often more natural to many Ruby programmers.
The <code>Async</code> module is a way to mix simple yet powerful asynchronous capabilities
into any plain old Ruby object or class. These capabilities provide a reasonable
level of thread safe guarantees when used correctly.</p>

<p>When this module is mixed into a class or object it provides to new methods:
<code>async</code> and <code>await</code>. These methods are thread safe with respect to the enclosing
object. The former method allows methods to be called asynchronously by posting
to the global thread pool. The latter allows a method to be called synchronously
on the current thread but does so safely with respect to any pending asynchronous
method calls. Both methods return an <code>IVar</code> which can be inspected for
the result of the method call. Calling a method with <code>async</code> will return a
<code>:pending</code> <code>IVar</code> whereas <code>await</code> will return a <code>:complete</code> <code>IVar</code>.</p>

<p>Very loosely based on the <code>async</code> and <code>await</code> keywords in C#.</p>

<h3>An Important Note About Thread Safe Guarantees</h3>

<blockquote>
<p>Thread safe guarantees can only be made when asynchronous method calls
are not mixed with synchronous method calls. Use only synchronous calls
when the object is used exclusively on a single thread. Use only
<code>async</code> and <code>await</code> when the object is shared between threads. Once you
call a method using <code>async</code>, you should no longer call any methods
directly on the object. Use <code>async</code> and <code>await</code> exclusively from then on.
With careful programming it is possible to switch back and forth but it&#39;s
also very easy to create race conditions and break your application.
Basically, it&#39;s &quot;async all the way down.&quot;</p>
</blockquote>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>
<span class='kw'>class</span> <span class='const'>Echo</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>Async</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_echo'>echo</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='id identifier rubyid_rand'>rand</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_horn'>horn</span> <span class='op'>=</span> <span class='const'>Echo</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='id identifier rubyid_horn'>horn</span><span class='period'>.</span><span class='id identifier rubyid_echo'>echo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>zero</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>      <span class='comment'># synchronous, not thread-safe
</span>
<span class='id identifier rubyid_horn'>horn</span><span class='period'>.</span><span class='id identifier rubyid_async'>async</span><span class='period'>.</span><span class='id identifier rubyid_echo'>echo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>one</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># asynchronous, non-blocking, thread-safe
</span><span class='id identifier rubyid_horn'>horn</span><span class='period'>.</span><span class='id identifier rubyid_await'>await</span><span class='period'>.</span><span class='id identifier rubyid_echo'>echo</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>two</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='comment'># synchronous, blocking, thread-safe</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></li>
    
  </ul>

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new-class_method" title="new (class method)">+ (Object) <strong>new</strong>(*args, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Instanciate a new object and ensure proper initialization of the synchronization mechanisms.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#async-instance_method" title="#async (instance method)">- (Concurrent::IVar) <strong>async</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Causes the chained method call to be performed asynchronously on the global thread pool.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#await-instance_method" title="#await (instance method)">- (Concurrent::IVar) <strong>await</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Causes the chained method call to be performed synchronously on the current thread.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#executor%3D-instance_method" title="#executor= (instance method)">- (Object) <strong>executor=</strong>(executor) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set a new executor.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="new-class_method">
  
    + (<tt>Object</tt>) <strong>new</strong>(*args, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Instanciate a new object and ensure proper initialization of the
synchronization mechanisms.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array&lt;Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Zero or more arguments to be passed to the
object&#39;s initializer.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>bloc</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Optional block to pass to the object&#39;s initializer.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A properly initialized object of the asynchronous class.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/async.rb', line 73</span>

</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="async-instance_method">
  
    - (<tt><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">Concurrent::IVar</a></span></tt>) <strong>async</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>The method call is guaranteed to be thread safe with respect to
all other method calls against the same object that are called with
either <code>async</code> or <code>await</code>. The mutable nature of Ruby references
(and object orientation in general) prevent any other thread safety
guarantees. Do NOT mix non-protected method calls with protected
method call. Use <em>only</em> protected method calls when sharing the object
between threads.</p>
</div>
  </div>

<p>Causes the chained method call to be performed asynchronously on the
global thread pool. The method called by this method will return a
future object in the <code>:pending</code> state and the method call will have
been scheduled on the global thread pool. The final disposition of the
method call can be obtained by inspecting the returned future.</p>

<p>Before scheduling the method on the global thread pool a best-effort
attempt will be made to validate that the method exists on the object
and that the given arguments match the arity of the requested function.
Due to the dynamic nature of Ruby and limitations of its reflection
library, some edge cases will be missed. For more information see
the documentation for the <code>validate_argc</code> method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">Concurrent::IVar</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the pending result of the asynchronous operation</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NameError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the object does not respond to <code>method</code> method</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the given <code>args</code> do not match the arity of <code>method</code></p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/async.rb', line 214</span>

<span class='kw'>def</span> <span class='id identifier rubyid_async'>async</span>
  <span class='ivar'>@__async_delegator__</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="await-instance_method">
  
    - (<tt><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">Concurrent::IVar</a></span></tt>) <strong>await</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>The method call is guaranteed to be thread safe with respect to
all other method calls against the same object that are called with
either <code>async</code> or <code>await</code>. The mutable nature of Ruby references
(and object orientation in general) prevent any other thread safety
guarantees. Do NOT mix non-protected method calls with protected
method call. Use <em>only</em> protected method calls when sharing the object
between threads.</p>
</div>
  </div>

<p>Causes the chained method call to be performed synchronously on the
current thread. The method called by this method will return an
<code>IVar</code> object in either the <code>:fulfilled</code> or <code>rejected</code> state and the
method call will have completed. The final disposition of the
method call can be obtained by inspecting the returned <code>IVar</code>.</p>

<p>Before scheduling the method on the global thread pool a best-effort
attempt will be made to validate that the method exists on the object
and that the given arguments match the arity of the requested function.
Due to the dynamic nature of Ruby and limitations of its reflection
library, some edge cases will be missed. For more information see
the documentation for the <code>validate_argc</code> method.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">Concurrent::IVar</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the completed result of the synchronous operation</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NameError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the object does not respond to <code>method</code> method</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the given <code>args</code> do not match the arity of <code>method</code></p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/async.rb', line 239</span>

<span class='kw'>def</span> <span class='id identifier rubyid_await'>await</span>
  <span class='ivar'>@__await_delegator__</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="executor=-instance_method">
  
    - (<tt>Object</tt>) <strong>executor=</strong>(executor) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Set a new executor.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>executor has already been set.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


246
247
248
249</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/async.rb', line 246</span>

<span class='kw'>def</span> <span class='id identifier rubyid_executor='>executor=</span><span class='lparen'>(</span><span class='id identifier rubyid_executor'>executor</span><span class='rparen'>)</span>
  <span class='ivar'>@__async_executor__</span><span class='period'>.</span><span class='id identifier rubyid_reconfigure'>reconfigure</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_executor'>executor</span> <span class='rbrace'>}</span> <span class='kw'>or</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>executor has already been set</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Aug  9 12:17:06 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.2).
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57940973-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>