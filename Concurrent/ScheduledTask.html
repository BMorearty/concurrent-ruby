<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Concurrent::ScheduledTask
  
    &mdash; Concurrent
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Concurrent/ScheduledTask.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span>
     &raquo; 
    <span class="title">ScheduledTask</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Concurrent::ScheduledTask
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="IVar.html" title="Concurrent::IVar (class)">IVar</a></span></li>
          
            <li class="next">Concurrent::ScheduledTask</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/concurrent/scheduled_task.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Time calculations one all platforms and languages are sensitive to
changes to the system clock. To alleviate the potential problems
associated with changing the system clock while an application is running,
most modern operating systems provide a monotonic clock that operates
independently of the system clock. A monotonic clock cannot be used to
determine human-friendly clock times. A monotonic clock is used exclusively
for calculating time intervals. Not all Ruby platforms provide access to an
operating system monotonic clock. On these platforms a pure-Ruby monotonic
clock will be used as a fallback. An operating system monotonic clock is both
faster and more reliable than the pure-Ruby implementation. The pure-Ruby
implementation should be fast and reliable enough for most non-realtime
operations. At this time the common Ruby platforms that provide access to an
operating system monotonic clock are MRI 2.1 and above and JRuby (all versions).</p>
</div>
  </div>

<p><code>ScheduledTask</code> is a close relative of <code>Concurrent::Future</code> but with one
important difference: A <code>Future</code> is set to execute as soon as possible
whereas a <code>ScheduledTask</code> is set to execute after a specified delay. This
implementation is loosely based on Java&#39;s
<a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html">ScheduledExecutorService</a>. </p>

<p>The <em>intended</em> schedule time of task execution is set on object construction
with the <code>delay</code> argument. The delay is a numeric (floating point or integer)
representing a number of seconds in the future. Any other value or a numeric
equal to or less than zero will result in an exception. The <em>actual</em> schedule
time of task execution is set when the <code>execute</code> method is called.</p>

<p>The constructor can also be given zero or more processing options. Currently
the only supported options are those recognized by the
<a href="Dereferenceable">Dereferenceable</a> module. </p>

<p>The final constructor argument is a block representing the task to be performed.
If no block is given an <code>ArgumentError</code> will be raised.</p>

<p><strong>States</strong></p>

<p><code>ScheduledTask</code> mixes in the  <a href="Obligation">Obligation</a> module thus giving it
&quot;future&quot; behavior. This includes the expected lifecycle states. <code>ScheduledTask</code>
has one additional state, however. While the task (block) is being executed the
state of the object will be <code>:in_progress</code>. This additional state is necessary
because it has implications for task cancellation. </p>

<p><strong>Cancellation</strong></p>

<p>A <code>:pending</code> task can be cancelled using the <code>#cancel</code> method. A task in any
other state, including <code>:in_progress</code>, cannot be cancelled. The <code>#cancel</code>
method returns a boolean indicating the success of the cancellation attempt.
A cancelled <code>ScheduledTask</code> cannot be restarted. It is immutable. </p>

<p><strong>Obligation and Observation</strong></p>

<p>The result of a <code>ScheduledTask</code> can be obtained either synchronously or
asynchronously. <code>ScheduledTask</code> mixes in both the <a href="Obligation">Obligation</a>
module and the
<a href="http://ruby-doc.org/stdlib-2.0/libdoc/observer/rdoc/Observable.html">Observable</a>
module from the Ruby standard library. With one exception <code>ScheduledTask</code>
behaves identically to <a href="Observable">Future</a> with regard to these modules.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Basic usage</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>concurrent</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>thread</span><span class='tstring_end'>&#39;</span></span>   <span class='comment'># for Queue
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>open-uri</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># for open(uri)
</span>
<span class='kw'>class</span> <span class='const'>Ticker</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='id identifier rubyid_symbol'>symbol</span><span class='comma'>,</span> <span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://ichart.finance.yahoo.com/table.csv?s=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_symbol'>symbol</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;a=11&amp;b=01&amp;c=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_year'>year</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;d=11&amp;e=31&amp;f=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_year'>year</span><span class='embexpr_end'>}</span><span class='tstring_content'>&amp;g=m</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># Future
</span><span class='id identifier rubyid_price'>price</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>Future</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lbrace'>{</span> <span class='const'>Ticker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TWTR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2013</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :pending
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>    <span class='comment'># do other stuff
</span><span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='comment'>#=&gt; 63.65
</span><span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :fulfilled
</span>
<span class='comment'># ScheduledTask
</span><span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='const'>Ticker</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_get_year_end_closing'>get_year_end_closing</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INTC</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='int'>2013</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='comment'>#=&gt; :pending
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>   <span class='comment'># do other stuff
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span> <span class='comment'>#=&gt; 25.96</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Successful task execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; :unscheduled
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_unscheduled?'>unscheduled?</span> <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>     <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled?'>fulfilled?</span>   <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_rejected?'>rejected?</span>    <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>        <span class='comment'>#=&gt; &#39;What does the fox say?&#39;</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>One line creation and execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending
</span>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What do you get when you multiply 6 by 9?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>         <span class='comment'>#=&gt; pending</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Failed task execution</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Call me maybe?</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>      <span class='comment'>#=&gt; true
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_unscheduled?'>unscheduled?</span> <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>     <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled?'>fulfilled?</span>   <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_rejected?'>rejected?</span>    <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>        <span class='comment'>#=&gt; nil
</span><span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span>       <span class='comment'>#=&gt; #&lt;StandardError: Call me maybe?&gt; </span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Task execution with observation</p>
</div></p>
      
      <pre class="example code"><code>
<span class='id identifier rubyid_observer'>observer</span> <span class='op'>=</span> <span class='const'>Class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lbrace'>{</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The task completed at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'> with value &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

<span class='id identifier rubyid_task'>task</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What does the fox say?</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_add_observer'>add_observer</span><span class='lparen'>(</span><span class='id identifier rubyid_observer'>observer</span><span class='rparen'>)</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_pending?'>pending?</span>      <span class='comment'>#=&gt; true
</span>
<span class='comment'># wait for it...
</span><span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>3</span><span class='rparen'>)</span>

<span class='comment'>#&gt;&gt; The task completed at 2013-11-07 12:26:09 -0500 with value &#39;What does the fox say?&#39;</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="http://linux.die.net/man/3/clock_gettime" target="_parent" title="Linux clock_gettime(3)">Linux clock_gettime(3)</a></li>
    
  </ul>

</div>
  <h2>Constant Summary</h2>
  




  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#delay-instance_method" title="#delay (instance method)">- (Object) <strong>delay</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute delay.</p>
</div></span>
  
</li>

    
      <li class="protected ">
  <span class="summary_signature">
    
      <a href="#observers-instance_method" title="#observers (instance method)">- (Object) <strong>observers</strong> </a>
    

    
  </span>
  
    <span class="note title not_defined_here">
      included
      from <span class='object_link'><a href="Observable.html#observers-instance_method" title="Concurrent::Observable#observers (method)">Observable</a></span>
    </span>
  
  
  
    
    
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute observers.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-class_method" title="execute (class method)">+ (ScheduledTask) <strong>execute</strong>(delay, opts = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a new <code>ScheduledTask</code> object with the given block, execute it, and return the <code>:pending</code> object.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancel-instance_method" title="#cancel (instance method)">- (Boolean) <strong>cancel</strong> </a>
    

    
      (also: #stop)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Cancel this task and prevent it from executing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancelled%3F-instance_method" title="#cancelled? (instance method)">- (Boolean) <strong>cancelled?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Has the task been cancelled?.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#complete-instance_method" title="#complete (instance method)">- (Object) <strong>complete</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">- (ScheduledTask) <strong>execute</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute an <code>:unscheduled</code> <code>ScheduledTask</code>.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#fail-instance_method" title="#fail (instance method)">- (Object) <strong>fail</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_progress%3F-instance_method" title="#in_progress? (instance method)">- (Boolean) <strong>in_progress?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>In the task execution in progress?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ScheduledTask) <strong>initialize</strong>(delay, opts = {}) { ... }</a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Schedule a task for execution at a specified future time.</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#schedule_time-instance_method" title="#schedule_time (instance method)">- (Object) <strong>schedule_time</strong> </a>
    

    
  </span>
  
  
  
  
  
  <span class="deprecated note title">deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#set-instance_method" title="#set (instance method)">- (Object) <strong>set</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>) <strong>initialize</strong>(delay, opts = {}) { ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Scheduling is now based on a monotonic clock. This makes the timer much
more accurate, but only when scheduling based on a delay interval.
Scheduling a task based on a clock time is deprecated. It will still work
but will not be supported in the 1.0 release.</p>
</div>
  </div>

<p>Schedule a task for execution at a specified future time.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>delay</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the number of seconds to wait for before executing the task</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options controlling how the future will be processed</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:operation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>when <code>true</code> will execute the future on the global
operation pool (for long-running operations), when <code>false</code> will execute the future on the
global task pool (for short-running tasks)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:executor</span>
          <span class="type">(<tt>object</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>when provided will run all operations on
this executor rather than the global thread pool (overrides :operation)</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>the task to be performed</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no block given</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='ivar'>@delay</span> <span class='op'>=</span> <span class='const'>TimerSet</span><span class='period'>.</span><span class='id identifier rubyid_calculate_delay!'>calculate_delay!</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='rparen'>)</span>

  <span class='kw'>super</span><span class='lparen'>(</span><span class='const'>NO_VALUE</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_observers'>observers</span> <span class='op'>=</span> <span class='const'>CopyOnNotifyObserverSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@state</span>         <span class='op'>=</span> <span class='symbol'>:unscheduled</span>
  <span class='ivar'>@task</span>          <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@executor</span>      <span class='op'>=</span> <span class='id identifier rubyid_get_executor_from'>get_executor_from</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='const'>Concurrent</span><span class='period'>.</span><span class='id identifier rubyid_global_io_executor'>global_io_executor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="delay-instance_method">
  
    - (<tt>Object</tt>) <strong>delay</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute delay</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delay'>delay</span>
  <span class='ivar'>@delay</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="observers=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="observers-instance_method">
  
    - (<tt>Object</tt>) <strong>observers</strong>  <span class="extras">(protected)</span>
  

  

  
    <span class="not_defined_here">
      Originally defined in module
        <span class='object_link'><a href="Observable.html#observers-instance_method" title="Concurrent::Observable#observers (method)">Observable</a></span>
    </span>
  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute observers</p>


  </div>
</div>
<div class="tags">
  

</div>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="execute-class_method">
  
    + (<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>) <strong>execute</strong>(delay, opts = {}, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Scheduling is now based on a monotonic clock. This makes the timer much
more accurate, but only when scheduling based on a delay interval.
Scheduling a task based on a clock time is deprecated. It will still work
but will not be supported in the 1.0 release.</p>
</div>
  </div>

<p>Create a new <code>ScheduledTask</code> object with the given block, execute it, and return the
<code>:pending</code> object.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>delay</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the number of seconds to wait for before executing the task</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the options controlling how the future will be processed</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:operation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>when <code>true</code> will execute the future on the global
operation pool (for long-running operations), when <code>false</code> will execute the future on the
global task pool (for short-running tasks)</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:executor</span>
          <span class="type">(<tt>object</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>when provided will run all operations on
this executor rather than the global thread pool (overrides :operation)</p>
</div>
          
        </li>
      
    </ul>
  
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the newly created <code>ScheduledTask</code> in the <code>:pending</code> state</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if no block is given</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 202</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'>ScheduledTask</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_delay'>delay</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cancel-instance_method">
  
    - (<tt>Boolean</tt>) <strong>cancel</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='stop-instance_method'>stop</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Cancel this task and prevent it from executing. A task can only be
cancelled if it is pending or unscheduled.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if task execution is successfully cancelled
else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


231
232
233
234
235
236
237</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 231</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancel'>cancel</span>
  <span class='id identifier rubyid_if_state'>if_state</span><span class='lparen'>(</span><span class='symbol'>:unscheduled</span><span class='comma'>,</span> <span class='symbol'>:pending</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='ivar'>@state</span> <span class='op'>=</span> <span class='symbol'>:cancelled</span>
    <span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cancelled?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>cancelled?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Has the task been cancelled?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the task is in the given state else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 215</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancelled?'>cancelled?</span>
  <span class='id identifier rubyid_state'>state</span> <span class='op'>==</span> <span class='symbol'>:cancelled</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="complete-instance_method">
  
    - (<tt>Object</tt>) <strong>complete</strong>  <span class="extras">(protected)</span>
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>) <strong>execute</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute an <code>:unscheduled</code> <code>ScheduledTask</code>. Immediately sets the state to <code>:pending</code>
and starts counting down toward execution. Does nothing if the <code>ScheduledTask</code> is
in any state other than <code>:unscheduled</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ScheduledTask (class)">ScheduledTask</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a reference to <code>self</code></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_execute'>execute</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_compare_and_set_state'>compare_and_set_state</span><span class='lparen'>(</span><span class='symbol'>:pending</span><span class='comma'>,</span> <span class='symbol'>:unscheduled</span><span class='rparen'>)</span>
    <span class='ivar'>@schedule_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='ivar'>@delay</span>
    <span class='const'>Concurrent</span><span class='op'>::</span><span class='id identifier rubyid_timer'>timer</span><span class='lparen'>(</span><span class='ivar'>@delay</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='ivar'>@executor</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span><span class='lparen'>(</span><span class='symbol'>:process_task</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fail-instance_method">
  
    - (<tt>Object</tt>) <strong>fail</strong>  <span class="extras">(protected)</span>
  

  

  
</h3>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_progress?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>in_progress?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>In the task execution in progress?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the task is in the given state else false</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_in_progress?'>in_progress?</span>
  <span class='id identifier rubyid_state'>state</span> <span class='op'>==</span> <span class='symbol'>:in_progress</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="schedule_time-instance_method">
  
    - (<tt>Object</tt>) <strong>schedule_time</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'></div></div>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/scheduled_task.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_schedule_time'>schedule_time</span>
  <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>[DEPRECATED] time is now based on a monotonic clock</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@schedule_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set-instance_method">
  
    - (<tt>Object</tt>) <strong>set</strong>  <span class="extras">(protected)</span>
  

  

  
</h3>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Mon Mar  9 09:50:51 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57940973-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>